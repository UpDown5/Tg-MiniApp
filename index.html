<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lucky Spin Casino</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* ========================================================================= */
        /* 1. –ü–ï–†–ï–ú–ï–ù–ù–´–ï –ò –û–°–ù–û–í–ù–ê–Ø –¢–ï–ú–ê (DARK THEME)                               */
        /* ========================================================================= */
        :root {
            /* –¶–≤–µ—Ç–∞, –∏–º–∏—Ç–∏—Ä—É—é—â–∏–µ —Ç–µ–º–Ω—É—é —Ç–µ–º—É Telegram –∏ –∫–∞–∑–∏–Ω–æ */
            --tg-theme-bg-color: #12121e; /* –û—á–µ–Ω—å —Ç–µ–º–Ω—ã–π —Ñ–æ–Ω */
            --tg-theme-text-color: #e0e0e0; /* –°–≤–µ—Ç–ª—ã–π —Ç–µ–∫—Å—Ç */
            --tg-theme-secondary-bg-color: #1e1e3b; /* –í—Ç–æ—Ä–∏—á–Ω—ã–π —Ñ–æ–Ω –¥–ª—è –±–ª–æ–∫–æ–≤ */
            --tg-theme-button-color: #00bcd4; /* –Ø—Ä–∫–∏–π –∞–∫—Ü–µ–Ω—Ç–Ω—ã–π —Å–∏–Ω–∏–π (–∫–∞–∫ –≤ Telegram) */
            --tg-theme-button-text-color: #ffffff; /* –ë–µ–ª—ã–π —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ */
            --tg-theme-hint-color: #7f8c8d; /* –°–µ—Ä—ã–π —Ç–µ–∫—Å—Ç –ø–æ–¥—Å–∫–∞–∑–æ–∫ */
            
            /* –¶–≤–µ—Ç–∞ –¥–ª—è —Å–µ–∫—Ç–æ—Ä–æ–≤ –∫–æ–ª–µ—Å–∞ */
            --sector-red: #e74c3c;
            --sector-green: #2ecc71;
            --sector-blue: #3498db;
            --sector-yellow: #f1c40f;
            --wheel-border: #ffd700; /* –ó–æ–ª–æ—Ç–æ–π –æ–±–æ–¥ */
        }

        body {
            font-family: 'Montserrat', sans-serif;
            text-align: center;
            padding: 0;
            margin: 0;
            background-color: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
        }

        /* –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º—ã Telegram –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º */
        body.tg-theme button {
            background-color: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
        }
        body.tg-theme input {
            background-color: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            border-color: var(--tg-theme-hint-color);
        }

        .container {
            max-width: 420px;
            width: 90%;
            background: var(--tg-theme-secondary-bg-color);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* ========================================================================= */
        /* 2. –¢–ò–¢–£–õ–¨–ù–´–ï –≠–õ–ï–ú–ï–ù–¢–´ –ò –ë–ê–õ–ê–ù–°                                           */
        /* ========================================================================= */
        h1 {
            color: var(--wheel-border); /* –ó–æ–ª–æ—Ç–∏—Å—Ç—ã–π —Ü–≤–µ—Ç */
            margin-bottom: 25px;
            font-weight: 700;
            font-size: 2.2em;
            letter-spacing: 2px;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
        }

        .balance {
            font-size: 1.3em;
            margin-bottom: 30px;
            padding: 15px;
            background: var(--tg-theme-bg-color);
            border-radius: 10px;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: 600;
        }
        .balance span {
            color: var(--wheel-border);
            margin-left: 10px;
            font-size: 1.2em;
        }

        /* ========================================================================= */
        /* 3. –ö–û–ù–¢–†–û–õ–õ–ï–†–´ (–°–¢–ê–í–ö–ê –ò –ö–ù–û–ü–ö–ê)                                         */
        /* ========================================================================= */
        .controls {
            margin-bottom: 30px;
            display: flex;
            gap: 10px;
        }

        .controls input {
            flex-grow: 1;
            padding: 12px 15px;
            border-radius: 8px;
            border: 1px solid var(--tg-theme-hint-color);
            font-size: 1.1em;
            background-color: rgba(255, 255, 255, 0.05);
            color: var(--tg-theme-text-color);
            text-align: center;
            transition: border-color 0.2s;
        }
        .controls input:focus {
            outline: none;
            border-color: var(--tg-theme-button-color);
        }

        .controls button {
            padding: 12px 25px;
            border-radius: 8px;
            border: none;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
        }

        .controls button:hover:not(:disabled) {
            filter: brightness(1.15);
            transform: translateY(-1px);
        }
        
        .controls button:disabled {
            background-color: var(--tg-theme-hint-color);
            cursor: not-allowed;
            opacity: 0.6;
        }

        /* ========================================================================= */
        /* 4. –ö–û–õ–ï–°–û –§–û–†–¢–£–ù–´ (SVG)                                                 */
        /* ========================================================================= */
        .wheel-container {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 30px auto;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.5), 0 0 20px rgba(0, 189, 212, 0.3);
            border: 12px solid var(--wheel-border);
            background-color: var(--tg-theme-bg-color); /* –§–æ–Ω –ø–æ–¥ –∫–æ–ª–µ—Å–æ–º */
        }

        .wheel-svg {
            width: 100%;
            height: 100%;
            transform-origin: center center;
            transition: transform 3s cubic-bezier(0.25, 0.1, 0.25, 1);
        }

        .wheel-pointer {
            position: absolute;
            top: -20px; /* –í—ã—à–µ –∫—Ä–∞—è –æ–±–æ–¥–∞ */
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 18px solid transparent;
            border-right: 18px solid transparent;
            border-bottom: 30px solid var(--tg-theme-text-color); /* –°–≤–µ—Ç–ª–∞—è —Å—Ç—Ä–µ–ª–∫–∞ */
            z-index: 10;
            filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.5));
        }

        .sector-label {
            fill: #ffffff;
            font-size: 16px; /* –ß—É—Ç—å –º–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ –¥–ª—è SVG */
            font-weight: bold;
            text-anchor: middle;
            dominant-baseline: middle;
            pointer-events: none;
        }
        
        /* –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫—Ä—É–≥ */
        .center-dot {
            fill: var(--wheel-border);
            stroke: #333;
            stroke-width: 2;
        }

        /* ========================================================================= */
        /* 5. –°–û–û–ë–©–ï–ù–ò–Ø –û –†–ï–ó–£–õ–¨–¢–ê–¢–ï                                                */
        /* ========================================================================= */
        .result {
            margin-top: 25px;
            font-size: 1.2em;
            font-weight: 700;
            color: var(--tg-theme-text-color);
            min-height: 25px; 
        }

        p.hint {
            margin-top: 30px;
            font-size: 0.85em;
            color: var(--tg-theme-hint-color);
        }
    </style>
</head>
<body class="tg-theme">
    <div class="container">
        <h1>Lucky Spin</h1>
        <div class="balance">
            –í–∞—à –±–∞–ª–∞–Ω—Å: <span id="userBalance">1000.00</span> üíé
        </div>

        <div class="controls">
            <input type="number" id="betInput" value="10" min="1" placeholder="–í–∞—à–∞ —Å—Ç–∞–≤–∫–∞">
            <button id="spinButton">–í—Ä–∞—â–∞—Ç—å –ö–æ–ª–µ—Å–æ</button>
        </div>

        <div class="wheel-container">
            <div class="wheel-pointer"></div>
            <svg id="wheel-svg-element" class="wheel-svg" viewBox="0 0 100 100">
                
                <path d="M50,50 L50,0 A50,50 0 0,1 85.355,14.645 L85.355,14.645 A50,50 0 0,1 100,50 Z" fill="var(--sector-red)"/>
                <text class="sector-label" x="75" y="25" transform="rotate(45 75 25)">x2</text>
                
                <path d="M50,50 L85.355,14.645 A50,50 0 0,1 50,100 Z" fill="var(--sector-blue)"/>
                <text class="sector-label" x="75" y="75" transform="rotate(135 75 75)">x0.5</text>
                
                <path d="M50,50 L14.645,85.355 A50,50 0 0,1 50,100 Z" fill="var(--sector-green)"/>
                <text class="sector-label" x="25" y="75" transform="rotate(225 25 75)">x0</text>
                
                <path d="M50,50 L14.645,85.355 A50,50 0 0,1 50,0 Z" fill="var(--sector-yellow)"/>
                <text class="sector-label" x="25" y="25" transform="rotate(315 25 25)">x3</text>

                <circle class="center-dot" cx="50" cy="50" r="15" />
            </svg>
        </div>

        <div class="result" id="gameResult">
            –ù–∞–∂–º–∏—Ç–µ "–í—Ä–∞—â–∞—Ç—å –ö–æ–ª–µ—Å–æ", —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å.
        </div>
        
        <p class="hint">
            *–≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –∫–æ–¥. –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–∞–∑–∏–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º –∑–∞—â–∏—â–µ–Ω–Ω—ã–π –±—ç–∫–µ–Ω–¥ –∏ Provably Fair —Å–∏—Å—Ç–µ–º–∞.
        </p>
    </div>

    <script>
        const WebApp = window.Telegram.WebApp;
        const userBalanceElem = document.getElementById('userBalance');
        const betInput = document.getElementById('betInput');
        const spinButton = document.getElementById('spinButton');
        const wheelSvg = document.getElementById('wheel-svg-element'); // –ò—Å–ø–æ–ª—å–∑—É–µ–º SVG —ç–ª–µ–º–µ–Ω—Ç
        const gameResult = document.getElementById('gameResult');
        
        let userBalance = 1000.00;
        let isSpinning = false;
        
        // –°–µ–∫—Ç–æ—Ä—ã –∫–æ–ª–µ—Å–∞: [–ù–∞–∑–≤–∞–Ω–∏–µ, –ú–Ω–æ–∂–∏—Ç–µ–ª—å, –£–≥–æ–ª –Ω–∞—á–∞–ª–∞ –¥–ª—è CSS (–ø—Ä–æ—Ç–∏–≤ —á–∞—Å–æ–≤–æ–π, 0=–≤–≤–µ—Ä—Ö)]
        // –£–≥–ª—ã: x2(0¬∞), x0.5(90¬∞), x0(180¬∞), x3(270¬∞)
        const sectors = [
            { name: 'x2', multiplier: 2, angle: 0, cssAngle: 315 },
            { name: 'x0.5', multiplier: 0.5, angle: 90, cssAngle: 45 },
            { name: 'x0', multiplier: 0, angle: 180, cssAngle: 135 },
            { name: 'x3', multiplier: 3, angle: 270, cssAngle: 225 }
        ];

        // --- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø TELEGRAM MINI APP ---
        function initTelegram() {
            if (WebApp.initDataUnsafe) {
                // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ü–≤–µ—Ç–æ–≤—É—é —Å—Ö–µ–º—É Telegram
                document.body.classList.add('tg-theme');
                WebApp.ready();
                
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º MainButton
                WebApp.MainButton.setText('–ü–æ–ø–æ–ª–Ω–∏—Ç—å –ë–∞–ª–∞–Ω—Å');
                WebApp.MainButton.onClick(showAlert);
                WebApp.MainButton.show();
            } else {
                gameResult.textContent = "–ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏ Telegram!";
            }
            // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å
            userBalanceElem.textContent = userBalance.toFixed(2);
        }
        
        function showAlert() {
            WebApp.showAlert('–í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –æ–∫–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è!');
        }

        // --- –õ–û–ì–ò–ö–ê –ò–ì–†–´ ---
        function spinWheel() {
            if (isSpinning) return;
            
            const bet = parseFloat(betInput.value);
            
            if (isNaN(bet) || bet <= 0 || bet.toFixed(2) === '0.00') {
                WebApp.showPopup({ message: "–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—Ç–∞–≤–∫—É." });
                return;
            }
            if (userBalance < bet) {
                WebApp.showPopup({ message: "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ!" });
                return;
            }

            // 1. –°–Ω–∏–º–∞–µ–º —Å—Ç–∞–≤–∫—É
            userBalance -= bet;
            userBalanceElem.textContent = userBalance.toFixed(2);
            spinButton.disabled = true;
            isSpinning = true;
            gameResult.textContent = '–í—Ä–∞—â–∞–µ–º... –£–¥–∞—á–∏!';

            // 2. –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            const winningSectorIndex = Math.floor(Math.random() * sectors.length); 
            const winningSector = sectors[winningSectorIndex];
            
            // 3. –í—ã—á–∏—Å–ª—è–µ–º —É–≥–æ–ª –ø–æ–≤–æ—Ä–æ—Ç–∞
            // 6-8 –ø–æ–ª–Ω—ã—Ö –æ–±–æ—Ä–æ—Ç–æ–≤ (2160¬∞ - 2880¬∞)
            const fullSpins = 360 * (6 + Math.floor(Math.random() * 3)); 
            
            // –£–≥–æ–ª –∫ —Ü–µ–Ω—Ç—Ä—É —Å–µ–∫—Ç–æ—Ä–∞: 
            // 360 - —É–≥–æ–ª –Ω–∞—á–∞–ª–∞ —Å–µ–∫—Ç–æ—Ä–∞ - (—Ä–∞–∑–º–µ—Ä —Å–µ–∫—Ç–æ—Ä–∞ / 2). 
            // –í SVG —Å–µ–∫—Ç–æ—Ä—ã –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å —É–≥–ª–æ–≤ 0, 90, 180, 270 (–ø–æ —á–∞—Å–æ–≤–æ–π)
            // –ú—ã –≤—Ä–∞—â–∞–µ–º –∫–æ–ª–µ—Å–æ, —á—Ç–æ–±—ã —Å—Ç—Ä–µ–ª–∫–∞ (–Ω–∞ 0¬∞) —É–∫–∞–∑–∞–ª–∞ –Ω–∞ —Ü–µ–Ω—Ç—Ä –≤—ã–∏–≥—Ä—ã—à–Ω–æ–≥–æ —Å–µ–∫—Ç–æ—Ä–∞.
            
            // –†–∞—Å—á–µ—Ç —É–≥–ª–∞ –¥–ª—è –ø–æ–ø–∞–¥–∞–Ω–∏—è –≤ –°–ï–†–ï–î–ò–ù–£ —Å–µ–∫—Ç–æ—Ä–∞:
            // –°–µ–∫—Ç–æ—Ä—ã –ø–æ 90 –≥—Ä–∞–¥—É—Å–æ–≤. –£–≥–æ–ª –¥–ª—è –ø–æ–ø–∞–¥–∞–Ω–∏—è –≤ —Ü–µ–Ω—Ç—Ä: SectorAngle + 45
            const targetSectorCenterAngle = winningSector.angle + 45; 
            
            // –ö–æ–ª–µ—Å–æ –≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ —á–∞—Å–æ–≤–æ–π, —á—Ç–æ–±—ã –ø–æ–ø–∞—Å—Ç—å –≤ targetSectorCenterAngle
            const finalRotation = fullSpins + (360 - targetSectorCenterAngle) + (Math.random() * 60 - 30); // –°–ª—É—á–∞–π–Ω—ã–π —Å–¥–≤–∏–≥ ¬±30¬∞

            // 4. –ó–∞–ø—É—Å–∫ –∞–Ω–∏–º–∞—Ü–∏–∏
            wheelSvg.style.transition = 'transform 3s cubic-bezier(0.25, 0.1, 0.25, 1.0)';
            wheelSvg.style.transform = `rotate(${finalRotation}deg)`;

            // 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
            setTimeout(() => {
                const multiplier = winningSector.multiplier;
                const winAmount = bet * multiplier;
                
                // –ù–∞—á–∏—Å–ª—è–µ–º –≤—ã–∏–≥—Ä—ã—à
                userBalance += winAmount;
                
                let message;
                if (multiplier > 1) {
                    message = `üéâ –ö–†–£–ü–ù–´–ô –í–´–ò–ì–†–´–®! +${(winAmount - bet).toFixed(2)} (x${multiplier.toFixed(1)}).`;
                } else if (multiplier === 1) {
                    message = `üëç –ù–∏—á—å—è. –í–∞—à–∞ —Å—Ç–∞–≤–∫–∞ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞.`;
                } else if (multiplier > 0 && multiplier < 1) {
                    message = `üìâ –ù–µ –ø–æ–≤–µ–∑–ª–æ. –í—ã–ø–∞–ª x${multiplier.toFixed(1)}. –ü–æ—Ç–µ—Ä—è–Ω–æ ${(bet - winAmount).toFixed(2)}.`;
                } else {
                    message = `üò≠ –ü—Ä–æ–∏–≥—Ä—ã—à! –í—ã–ø–∞–ª 'x0'. –ü–æ—Ç–µ—Ä—è–Ω–æ ${bet.toFixed(2)}.`;
                }
                
                userBalanceElem.textContent = userBalance.toFixed(2);
                gameResult.textContent = message;
                spinButton.disabled = false;
                isSpinning = false;
                
                // –°–±—Ä–æ—Å —Å—Ç–∏–ª—è –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤—Ä–∞—â–µ–Ω–∏—é
                wheelSvg.style.transition = 'none';
                wheelSvg.style.transform = `rotate(${finalRotation % 360}deg)`;
            }, 3000); // –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏
        }

        // –°–æ–±—ã—Ç–∏—è
        spinButton.addEventListener('click', spinWheel);

        // –ó–∞–ø—É—Å–∫
        initTelegram();
    </script>
</body>
</html>